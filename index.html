<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>í•œêµ­ ì„œí•‘ ìŠ¤íŒŸ ê°€ì´ë“œ â€“ ê°œì„ ì•ˆ v1</title>
  <style>
    * { box-sizing: border-box; }
    :root{
      --bg: #0891b2;
      --glass: rgba(255,255,255,.18);
      --glass-2: rgba(248,249,250,.22);
      --ink: #2c3e50;
      --muted: #6b8a99;
      --good-1:#27ae60;--good-2:#2ecc71;
      --bad-1:#e74c3c;--bad-2:#c0392b;
      --sand-1:#f39c12;--sand-2:#e67e22;
      --reef-1:#8e44ad;--reef-2:#9b59b6;
    }
    html,body{height:100%}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: var(--bg);
      background-image:url('https://images.unsplash.com/photo-1500530855697-b586d89ba3ee?auto=format&fit=crop&w=2070&q=80');
      background-position:center; background-size:cover; background-attachment:fixed;
      min-height:100vh; padding:20px;
    }
    .container{
      max-width:1200px; margin:0 auto; background:var(--glass);
      border-radius:16px; padding:24px; box-shadow:0 20px 40px rgba(0,0,0,.15);
      backdrop-filter:saturate(1.2) blur(10px);
    }
    header{ text-align:center; margin-bottom:16px; }
    header h1{ font-size:clamp(1.6rem, 2.4vw + 1rem, 2.6rem); color:var(--ink); margin:.2rem 0; }
    header p{ color:var(--muted); }

    .actions{ display:flex; gap:8px; flex-wrap:wrap; justify-content:space-between; align-items:center; margin:16px 0 12px; }
    .left-actions{ display:flex; gap:8px; flex-wrap:wrap; }
    input[type="search"], select{
      appearance:none; border:1px solid rgba(0,0,0,.08); background:white; border-radius:10px;
      padding:.6rem .8rem; font-size:.95rem; min-width:200px;
    }
    .toggle{ cursor:pointer; border:1px solid rgba(255,255,255,.5); background:var(--glass-2); color:#03414e; padding:.55rem .8rem; border-radius:10px; }

    .table-container{ overflow:auto; border-radius:12px; box-shadow:0 5px 15px rgba(0,0,0,.08); background:var(--glass);
      --sticky: sticky; }
    table{ width:100%; border-collapse:collapse; backdrop-filter: blur(4px); }
    caption{ text-align:left; padding:10px 12px; color:#0b3b47; font-weight:600; }
    thead{ position:var(--sticky); top:0; z-index:2; background:linear-gradient(135deg, #3498db, #2980b9); color:white; }
    th,td{ padding:12px 10px; text-align:center; }
    th{ font-weight:700; font-size:.9rem; }
    tbody tr{ transition: transform .16s ease, background-color .2s ease; }
    tbody tr:hover{ background-color: rgba(248,249,250,.5); transform: translateY(-1px); }
    tbody tr:nth-child(even){ background-color: rgba(248,249,250,.28); }

    .beach-info{ display:flex; align-items:center; gap:10px; }
    .beach-image{ width:44px; height:44px; border-radius:10px; object-fit:cover; box-shadow:0 2px 8px rgba(0,0,0,.15); }
    .beach-name{ font-weight:700; color:var(--ink); }
    .region{ color:#637a87; font-size:.92rem; }

    .wind-arrows{ display:flex; gap:6px; justify-content:center; flex-wrap:wrap; }
    .wind-arrow{ width:36px; height:24px; border-radius:12px; display:flex; align-items:center; justify-content:center; font-size:16px; color:white; font-weight:700; }
    .offshore{ background:linear-gradient(135deg, var(--good-1), var(--good-2)); box-shadow:0 2px 4px rgba(39,174,96,.28); }
    .onshore{ background:linear-gradient(135deg, var(--bad-1), var(--bad-2)); box-shadow:0 2px 4px rgba(231,76,60,.28); }

    /* ìŠ¤ì›°(íŒŒë„) í‘œì‹œ */
    .swell-arrows{ display:flex; gap:6px; justify-content:center; flex-wrap:wrap; }
    .swell-group{ display:flex; gap:4px; margin:2px 4px; }
    .swell-arrow{ width:36px; height:24px; border-radius:12px; display:flex; align-items:center; justify-content:center; font-size:16px; color:white; font-weight:700; background:linear-gradient(135deg,#1f9bd1,#0b3b47); box-shadow:0 2px 4px rgba(31,155,209,.28); }

    .bottom-type{ padding:5px 12px; border-radius:14px; font-size:.82rem; font-weight:700; color:white; display:inline-block; }
    .bottom-type.sand{ background:linear-gradient(135deg, var(--sand-1), var(--sand-2)); }
    .bottom-type.reef{ background:linear-gradient(135deg, var(--reef-1), var(--reef-2)); }

    .difficulty{ padding:4px 10px; border-radius:12px; font-size:.82rem; font-weight:700; color:white; }
    .beginner{ background:#2ecc71; }
    .intermediate{ background:#f39c12; }
    .advanced{ background:#e74c3c; }

    .legend, .tips{ background:var(--glass-2); padding:16px; border-radius:12px; margin-top:14px; backdrop-filter: blur(5px); }
    .legend h3, .tips h3{ margin:0 0 10px; color:var(--ink); }
    .legend-items{ display:grid; grid-template-columns:repeat(auto-fit, minmax(220px,1fr)); gap:10px; }
    .legend-item{ display:flex; align-items:center; gap:10px; }

    .tips ul{ list-style:none; padding-left:0; margin:0; }
    .tips li{ margin:8px 0; padding-left:22px; position:relative; }
    .tips li::before{ content:"ğŸŒŠ"; position:absolute; left:0; }

    /* ì¹´ë“œí˜• ë ˆì´ì•„ì›ƒ (ëª¨ë°”ì¼ ì „í™˜) */
    .cards{ display:none; grid-template-columns:repeat(auto-fill, minmax(260px, 1fr)); gap:12px; }
    .card{ background:var(--glass); border:1px solid rgba(255,255,255,.35); border-radius:14px; padding:12px; box-shadow:0 4px 12px rgba(0,0,0,.08); }
    .card header{ display:flex; align-items:center; gap:10px; justify-content:flex-start; margin-bottom:8px; }
    .meta{ display:flex; gap:8px; flex-wrap:wrap; align-items:center; }

    /* ì ‘ê·¼ì„± í–¥ìƒ */
    :focus-visible{ outline: 3px solid #1f9bd1; outline-offset: 2px; border-radius:8px; }
    @media (max-width: 820px){
      .container{ padding:14px; }
      th,td{ padding:9px 6px; font-size:.85rem; }
    }
    @media (max-width: 680px){
      .table-container{ display:none; }
      .cards{ display:grid; }
      input[type="search"], select{ min-width:0; flex:1; }
    }
    @media (prefers-reduced-motion: reduce){
      *{ animation:none !important; transition:none !important; }
    }
    /* ë°©í–¥ ìœ„ì ¯ */
  .direction-widget{margin-top:12px;display:grid;grid-template-columns:1fr;gap:10px}
  .dir-controls{display:flex;gap:6px;justify-content:center;flex-wrap:wrap}
  .dir-btn{border:1px solid rgba(255,255,255,.5);background:var(--glass-2);border-radius:10px;padding:6px 10px;cursor:pointer}
  .dir-btn[aria-pressed="true"]{outline:2px solid #1f9bd1}
  .compass{display:flex;justify-content:center}
  svg.compass-svg{width:220px;height:220px}
  .arrow{stroke-width:4;stroke-linecap:round}
  .sector{fill:rgba(255,255,255,.35);stroke:none}
  .arc{fill:none;stroke:#ffffff;stroke-opacity:.9;stroke-width:3}
  .label{font-size:12px;fill:#0b3b47}
</style>
</head>
<body>
  <div class="container" role="application">
    <header>
      <h1 aria-label="í•œêµ­ ì„œí•‘ ìŠ¤íŒŸ ê°€ì´ë“œ">ğŸ„â€â™‚ï¸ í•œêµ­ ì„œí•‘ ìŠ¤íŒŸ ê°€ì´ë“œ</h1>
      <p>êµ­ë‚´ ì£¼ìš” ìŠ¤íŒŸì˜ ë°”ëŒÂ·ë°”ë‹¥Â·ì‹œì¦Œ ì •ë³´ë¥¼ í•œëˆˆì—</p>
    </header>

    <div class="actions" aria-label="í•„í„° ë° ë³´ê¸° ì „í™˜">
      <div class="left-actions">
        <input id="q" type="search" placeholder="ìŠ¤íŒŸ ë˜ëŠ” ì§€ì—­ ê²€ìƒ‰" aria-label="ìŠ¤íŒŸ ê²€ìƒ‰" />
        <select id="regionFilter" aria-label="ì§€ì—­ í•„í„°">
          <option value="">ì „ì²´ ì§€ì—­</option>
        </select>
        <select id="levelFilter" aria-label="ë‚œì´ë„ í•„í„°">
          <option value="">ì „ì²´ ë‚œì´ë„</option>
          <option value="beginner">ì´ˆê¸‰</option>
          <option value="intermediate">ì¤‘ê¸‰</option>
          <option value="advanced">ê³ ê¸‰</option>
        </select>
      </div>
      <button class="toggle" id="sortBtn" aria-pressed="false">ê°€ë‚˜ë‹¤ ìˆœ ì •ë ¬</button>
    </div>

    <div class="table-container" role="region" aria-labelledby="tableCaption">
      <table id="surfTable">
        <caption id="tableCaption">í•œêµ­ ì„œí•‘ ìŠ¤íŒŸ ëª©ë¡</caption>
        <thead>
          <tr>
            <th scope="col">í•´ë³€</th>
            <th scope="col">ì§€ì—­</th>
            <th scope="col" title="ì˜¤í”„ì‡¼ì–´">ë°”ëŒ(ì˜¤í”„ì‡¼ì–´)</th>
            <th scope="col">íŒŒë„(ë² ìŠ¤íŠ¸)</th>
            <th scope="col">ë°”ë‹¥</th>
            <th scope="col">ë² ìŠ¤íŠ¸ ê³„ì ˆ</th>
            <th scope="col">ë² ìŠ¤íŠ¸ ì‹œê°„</th>
            <th scope="col">ë‚œì´ë„</th>
          </tr>
        </thead>
        <tbody id="tbody"></tbody>
      </table>
    </div>

    <section class="cards" id="cards" aria-label="ì¹´ë“œ ë³´ê¸°"></section>

    <section class="legend" aria-label="ë²”ë¡€">
      <h3>ë²”ë¡€</h3>
      <div class="legend-items">
        <div class="legend-item"><div class="wind-arrow offshore" aria-hidden="true">â†“</div><span>ì˜¤í”„ì‡¼ì–´ (ì¢‹ì€ ì¡°ê±´)</span></div>
        <div class="legend-item"><div class="wind-arrow onshore" aria-hidden="true">â†‘</div><span>ì˜¨ì‡¼ì–´ (í”¼í•˜ê¸°)</span></div>
        <div class="legend-item"><div class="bottom-type sand">ëª¨ë˜</div><span>ë§¨ë°œ OK</span></div>
        <div class="legend-item"><div class="bottom-type reef">ë¦¬í”„</div><span>ë¶€ì¸  ê¶Œì¥</span></div>
      </div>
    </section>

    <section class="tips" aria-label="ì„œí•‘ íŒ">
      <h3>ğŸ’¡ ì„œí•‘ íŒ</h3>
      <ul>
        <li><strong>ë°”ëŒ ì²´í¬:</strong> ì˜¤í”„ì‡¼ì–´ì¼ìˆ˜ë¡ íŒŒë„ê°€ ì •ëˆë©ë‹ˆë‹¤</li>
        <li><strong>ì¡°ì„:</strong> ë§Œì¡° ì „í›„ 2ì‹œê°„ì´ ë³´í¸ì ìœ¼ë¡œ ìœ ë¦¬í•©ë‹ˆë‹¤</li>
        <li><strong>ê³„ì ˆ:</strong> 9â€“10ì›”ì´ êµ­ë‚´ ë² ìŠ¤íŠ¸ ì‹œì¦Œ</li>
        <li><strong>ë¦¬í”„:</strong> ë¦¬í”„ ë¶€ì¸  ì°©ìš© ê¶Œì¥</li>
        <li><strong>í™”ì‚´í‘œ:</strong> ë°”ëŒì´ ë¶ˆì–´ê°€ëŠ” ë°©í–¥ í‘œì‹œ</li>
        <li><strong>ì˜¤í”„ì‡¼ì–´ì¼ ë•Œ íŒŒë„ ë°©í–¥:</strong> ìŠ¤ì›°ì€ í•´ì•ˆì„ ì— ì§ê°ì— ê°€ê¹ê²Œ ë°”ë‹¤â†’í•´ì•ˆìœ¼ë¡œ ë“¤ì–´ì˜¤ê³ , ë°”ëŒì€ ê·¸ ë°˜ëŒ€(ìœ¡ì§€â†’ë°”ë‹¤)ë¡œ ë¶ˆìˆ˜ë¡ ë¼ì¸ì´ ì •ëˆë©ë‹ˆë‹¤. ì˜ˆ: ë™í•´ ë™í–¥ í¬ì¸íŠ¸ëŠ” Eê³„ì—´ ìŠ¤ì›° + Wê³„ì—´ ì˜¤í”„ì‡¼ì–´ ì¡°í•©ì´ ì¢‹ìŠµë‹ˆë‹¤.</li>
      </ul>

      <!-- ë°”ëŒ-ìŠ¤ì›° ì‹œê°í™” ìœ„ì ¯ -->
      <div class="direction-widget" aria-label="ë°”ëŒ-ìŠ¤ì›° ì‹œê°í™”">
        <div class="dir-controls" role="group" aria-label="ë°”ëŒ ë°©í–¥ ì„ íƒ">
          <button class="dir-btn" data-dir="N" aria-pressed="true">â†‘</button>
          <button class="dir-btn" data-dir="NE">â†—</button>
          <button class="dir-btn" data-dir="E">â†’</button>
          <button class="dir-btn" data-dir="SE">â†˜</button>
          <button class="dir-btn" data-dir="S">â†“</button>
          <button class="dir-btn" data-dir="SW">â†™</button>
          <button class="dir-btn" data-dir="W">â†</button>
          <button class="dir-btn" data-dir="NW">â†–</button>
        </div>
        <div class="compass">
          <svg class="compass-svg" viewBox="0 0 200 200" aria-label="ìŠ¤ì›° í—ˆìš© ë²”ìœ„">
            <circle cx="100" cy="100" r="90" fill="none" stroke="rgba(0,0,0,.25)" />
            <path id="sector" class="sector" d="" />
            <path id="arc30" class="arc" d="" />
            <g id="windArrow" transform="rotate(0 100 100)">
              <line x1="100" y1="100" x2="100" y2="25" class="arrow" stroke="url(#windGrad)" />
              <polygon points="100,12 94,28 106,28" fill="url(#windGrad)" />
            </g>
            <g id="swellArrow" transform="rotate(180 100 100)">
              <line x1="100" y1="100" x2="100" y2="175" class="arrow" stroke="url(#swellGrad)" />
              <polygon points="100,188 94,172 106,172" fill="url(#swellGrad)" />
            </g>
            <defs>
              <linearGradient id="windGrad" x1="0" y1="0" x2="0" y2="1">
                <stop offset="0%" stop-color="#1f9bd1"/>
                <stop offset="100%" stop-color="#0b3b47"/>
              </linearGradient>
              <linearGradient id="swellGrad" x1="0" y1="0" x2="0" y2="1">
                <stop offset="0%" stop-color="#27ae60"/>
                <stop offset="100%" stop-color="#2ecc71"/>
              </linearGradient>
            </defs>
            <text x="100" y="100" text-anchor="middle" dy="4" class="label">Â±30â€“45Â°</text>
          </svg>
        </div>
      </div>
    </section>
  </div>

  <script>
    const surfSpots = [
      { name:"ì†¡ì • í•´ìˆ˜ìš•ì¥", region:"ë¶€ì‚°", image:"https://images.unsplash.com/photo-1507525428034-b723cf961d3e?w=200&h=200&fit=crop", offshore:["NW","N","NE"], onshore:["SE","S","SW"], bottomType:"sand", bestSeason:"ì—°ì¤‘", bestTime:"ë§Œì¡° 2â€“3ì‹œê°„ ì „í›„", difficulty:"beginner" },
      { name:"ì£½ë„ í•´ë³€", region:"ì–‘ì–‘", image:"https://images.unsplash.com/photo-1544551763-46a013bb70d5?w=200&h=200&fit=crop", offshore:["W","NW","SW"], onshore:["E","NE","SE"], bottomType:"sand", bestSeason:"9â€“11ì›”", bestTime:"ë§Œì¡°ì‹œ", difficulty:"beginner" },
      { name:"ê¸°ì‚¬ë¬¸ í•´ë³€", region:"ì–‘ì–‘", image:"https://images.unsplash.com/photo-1544198365-f5d60b6d8190?w=200&h=200&fit=crop", offshore:["W","NW","SW"], onshore:["E","NE","SE"], bottomType:"sand", bestSeason:"9â€“11ì›”", bestTime:"ë§Œì¡° 1â€“2ì‹œê°„ ì „", difficulty:"intermediate" },
      { name:"ì„œí”¼ë¹„ì¹˜", region:"ì–‘ì–‘", image:"https://images.unsplash.com/photo-1502680390469-be75c86b636f?w=200&h=200&fit=crop", offshore:["W","NW","SW"], onshore:["E","NE","SE"], bottomType:"sand", bestSeason:"9â€“11ì›”", bestTime:"ë§Œì¡°ì‹œ", difficulty:"intermediate" },
      { name:"ë§Œë¦¬í¬ í•´ë³€", region:"íƒœì•ˆ", image:"https://images.unsplash.com/photo-1559827260-dc66d52bef19?w=200&h=200&fit=crop", offshore:["E","NE","SE"], onshore:["W","NW","SW"], bottomType:"sand", bestSeason:"ë´„Â·ê°€ì„", bestTime:"ë§Œì¡°ì‹œ", difficulty:"beginner" },
      { name:"ì¤‘ë¬¸ìƒ‰ë‹¬í•´ë³€", region:"ì œì£¼", image:"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=200&h=200&fit=crop", offshore:["N","NE","NW"], onshore:["S","SE","SW"], bottomType:"reef", bestSeason:"9â€“11ì›”Â·3â€“5ì›”", bestTime:"ë§Œì¡° 2ì‹œê°„ ì „í›„", difficulty:"advanced" },
      { name:"ê³ í¥ í•´ìˆ˜ìš•ì¥", region:"ì „ë‚¨ ê³ í¥", image:"https://images.unsplash.com/photo-1544551763-77ef2d0cfc6c?w=200&h=200&fit=crop", offshore:["N","NW","NE"], onshore:["S","SW","SE"], bottomType:"sand", bestSeason:"ì—°ì¤‘", bestTime:"ë§Œì¡°ì‹œ", difficulty:"intermediate" },
      { name:"ì›”í¬í•´ë³€", region:"í¬í•­", image:"https://images.unsplash.com/photo-1544551763-46a013bb70d5?w=200&h=200&fit=crop", offshore:["W","NW","SW"], onshore:["E","NE","SE"], bottomType:"sand", bestSeason:"9â€“11ì›”", bestTime:"ë§Œì¡° 1â€“2ì‹œê°„ ì „", difficulty:"intermediate" },
      { name:"ëŒ€ì§„í•´ë³€", region:"ë™í•´", image:"https://images.unsplash.com/photo-1507525428034-b723cf961d3e?w=200&h=200&fit=crop", offshore:["W","NW","SW"], onshore:["E","NE","SE"], bottomType:"sand", bestSeason:"9â€“11ì›”", bestTime:"ë§Œì¡° 2ì‹œê°„ ì „í›„", difficulty:"intermediate" },
      { name:"ì •ë™ì§„í•´ë³€", region:"ê°•ë¦‰", image:"https://images.unsplash.com/photo-1544198365-f5d60b6d8190?w=200&h=200&fit=crop", offshore:["W","NW","SW"], onshore:["E","NE","SE"], bottomType:"sand", bestSeason:"9â€“11ì›”", bestTime:"ë§Œì¡°ì‹œ", difficulty:"beginner" },
      { name:"ì†ì´ˆí•´ë³€", region:"ì†ì´ˆ", image:"https://images.unsplash.com/photo-1559827260-dc66d52bef19?w=200&h=200&fit=crop", offshore:["W","NW","SW"], onshore:["E","NE","SE"], bottomType:"sand", bestSeason:"9â€“11ì›”", bestTime:"ë§Œì¡° 1â€“2ì‹œê°„ ì „", difficulty:"beginner" },
      { name:"ì‚¼í¬í•´ë³€", region:"ê³ ì„±", image:"https://images.unsplash.com/photo-1502680390469-be75c86b636f?w=200&h=200&fit=crop", offshore:["W","NW","SW"], onshore:["E","NE","SE"], bottomType:"sand", bestSeason:"9â€“11ì›”", bestTime:"ë§Œì¡°ì‹œ", difficulty:"intermediate" },
      { name:"ê°•ë¬¸í•´ë³€", region:"ê°•ë¦‰", image:"https://images.unsplash.com/photo-1544551763-77ef2d0cfc6c?w=200&h=200&fit=crop", offshore:["W","NW","SW"], onshore:["E","NE","SE"], bottomType:"sand", bestSeason:"9â€“11ì›”", bestTime:"ë§Œì¡° 2ì‹œê°„ ì „í›„", difficulty:"beginner" },
      { name:"ê²½í¬í•´ë³€", region:"ê°•ë¦‰", image:"https://images.unsplash.com/photo-1507525428034-b723cf961d3e?w=200&h=200&fit=crop", offshore:["W","NW","SW"], onshore:["E","NE","SE"], bottomType:"sand", bestSeason:"9â€“11ì›”", bestTime:"ë§Œì¡°ì‹œ", difficulty:"beginner" },
    ];

    const ARROWS = { N:"â†“", NE:"â†™", E:"â†", SE:"â†–", S:"â†‘", SW:"â†—", W:"â†’", NW:"â†˜" };

    const $tbody = document.getElementById('tbody');
    const $cards = document.getElementById('cards');
    const $q = document.getElementById('q');
    const $regionFilter = document.getElementById('regionFilter');
    const $levelFilter = document.getElementById('levelFilter');
    const $sortBtn = document.getElementById('sortBtn');

    let state = { sortAsc: true, query:"", region:"", level:"" };

    const DIRS = ['N','NE','E','SE','S','SW','W','NW'];
    function waveTripletFromOffshore(dir){
      const idx = DIRS.indexOf(dir);
      const opp = (idx + 4) % 8; // ë°˜ëŒ€ ë°©í–¥(ìŠ¤ì›° ì¤‘ì‹¬)
      const left = (opp + 7) % 8; // -45Â° ì¸ì ‘
      const right = (opp + 1) % 8; // +45Â° ì¸ì ‘
      return [DIRS[left], DIRS[opp], DIRS[right]];
    }
    function waveGroup(offshoreList){
      const groups = offshoreList.map(d=>{
        const tri = waveTripletFromOffshore(d);
        const arrows = tri.map(t=>`<span class='swell-arrow' title='ìŠ¤ì›° ${t}'>${ARROWS[t]}</span>`).join('');
        return `<span class='swell-group' aria-label='${d} ì˜¤í”„ì‡¼ì–´ ëŒ€ë¹„ ë² ìŠ¤íŠ¸ ìŠ¤ì›°'>${arrows}</span>`;
      });
      return `<div class='swell-arrows'>${groups.join('')}</div>`;
    }


    // region options
    [...new Set(surfSpots.map(s=>s.region))].sort().forEach(r=>{
      const opt=document.createElement('option'); opt.value=r; opt.textContent=r; $regionFilter.appendChild(opt);
    });

    function windGroup(spot){
      const off = spot.offshore.map(w=>`<span class=\"wind-arrow offshore\" title=\"ì˜¤í”„ì‡¼ì–´ ${w}\">${ARROWS[w]}</span>`).join('');
      return `<div class=\"wind-arrows\" aria-label=\"ì˜¤í”„ì‡¼ì–´\">${off}</div>`;
    }">${ARROWS[w]}</span>`).join('');
      const on = spot.onshore.map(w=>`<span class="wind-arrow onshore" title="ì˜¨ì‡¼ì–´ ${w}">${ARROWS[w]}</span>`).join('');
      return `<div class="wind-arrows" aria-label="ë°”ëŒ"><div role="group" aria-label="ì˜¤í”„ì‡¼ì–´">${off}</div><div role="group" aria-label="ì˜¨ì‡¼ì–´">${on}</div></div>`;
    }

    function bottomBadge(type){
      const map={ sand:{t:'ëª¨ë˜',c:'sand'}, reef:{t:'ë¦¬í”„',c:'reef'} };
      const i=map[type]||{t:type,c:'sand'}; return `<span class="bottom-type ${i.c}">${i.t}</span>`;
    }

    function levelBadge(l){
      const map={ beginner:{t:'ì´ˆê¸‰',c:'beginner'}, intermediate:{t:'ì¤‘ê¸‰',c:'intermediate'}, advanced:{t:'ê³ ê¸‰',c:'advanced'} };
      const i=map[l]||{t:l,c:'beginner'}; return `<span class="difficulty ${i.c}">${i.t}</span>`;
    }

    function rowTemplate(s){
      return `<tr tabindex=\"0\">
        <td><div class=\"beach-info\"><img loading=\"lazy\" src=\"${s.image}\" alt=\"${s.name} ì‚¬ì§„\" class=\"beach-image\" width=\"44\" height=\"44\" /><div><div class=\"beach-name\">${s.name}</div></div></div></td>
        <td class=\"region\">${s.region}</td>
        <td>${windGroup(s)}</td>
        <td>${waveGroup(s.offshore)}</td>
        <td>${bottomBadge(s.bottomType)}</td>
        <td class=\"season\">${s.bestSeason}</td>
        <td class=\"time\">${s.bestTime}</td>
        <td>${levelBadge(s.difficulty)}</td>
      </tr>`;
    }

    function cardTemplate(s){
      return `<article class=\"card\" tabindex=\"0\" aria-label=\"${s.name}\">
        <header><img loading=\"lazy\" class=\"beach-image\" alt=\"${s.name} ì‚¬ì§„\" src=\"${s.image}\" width=\"44\" height=\"44\" /><strong>${s.name}</strong><span class=\"region\">Â· ${s.region}</span></header>
        <div class=\"meta\">${bottomBadge(s.bottomType)} ${levelBadge(s.difficulty)}</div>
        <div style=\"margin:8px 0;\">${windGroup(s)}</div>
        <div style=\"margin:6px 0;\">${waveGroup(s.offshore)}</div>
        <div class=\"meta\"><span>ì‹œì¦Œ: ${s.bestSeason}</span><span>ë² ìŠ¤íŠ¸: ${s.bestTime}</span></div>
      </article>`;
    }

    function applyFilters(){
      const q = state.query.toLowerCase();
      return surfSpots.filter(s=>
        (!state.region || s.region===state.region) &&
        (!state.level || s.difficulty===state.level) &&
        (s.name.toLowerCase().includes(q) || s.region.toLowerCase().includes(q))
      );
    }

    function render(){
      let data = applyFilters();
      data = data.sort((a,b)=> state.sortAsc ? a.name.localeCompare(b.name) : b.name.localeCompare(a.name));
      $tbody.innerHTML = data.map(rowTemplate).join('');
      $cards.innerHTML = data.map(cardTemplate).join('');
      // row interactions (keyboard + click)
      [...$tbody.querySelectorAll('tr'), ...$cards.querySelectorAll('.card')].forEach(el=>{
        el.addEventListener('click', ()=> tip(el.querySelector('.beach-name')?.textContent || el.getAttribute('aria-label')));
        el.addEventListener('keyup', (e)=>{ if(e.key==='Enter' || e.key===' ') { e.preventDefault(); el.click(); } });
      });
    }

    function tip(name){
      const msg = `${name}\n\nğŸ’¡ íŒ: ì˜¤í”„ì‡¼ì–´ì¼ ë•Œ ì»¨ë””ì…˜ì´ ì •ëˆë¼ìš”!\nğŸŒŠ ë§Œì¡° ì „í›„ 2ì‹œê°„ í™•ì¸í•˜ê¸°`;
      // lightweight toast instead of blocking alert
      toast(msg);
    }

    function toast(text){
      const t = document.createElement('div');
      t.textContent = text; t.setAttribute('role','status');
      Object.assign(t.style,{
        position:'fixed', left:'50%', bottom:'24px', transform:'translateX(-50%)',
        background:'rgba(0,0,0,.75)', color:'white', padding:'12px 14px', borderRadius:'12px',
        maxWidth:'min(90vw, 520px)', zIndex:9999, whiteSpace:'pre-wrap', textAlign:'left', boxShadow:'0 6px 18px rgba(0,0,0,.3)'
      });
      document.body.appendChild(t);
      setTimeout(()=> t.remove(), 2600);
    }

    // wiring
    $q.addEventListener('input', (e)=>{ state.query = e.target.value; render(); });
    $regionFilter.addEventListener('change', (e)=>{ state.region = e.target.value; render(); });
    $levelFilter.addEventListener('change', (e)=>{ state.level = e.target.value; render(); });
    $sortBtn.addEventListener('click', ()=>{ state.sortAsc = !state.sortAsc; $sortBtn.ariaPressed = String(!JSON.parse($sortBtn.ariaPressed||'false')); $sortBtn.textContent = state.sortAsc ? 'ê°€ë‚˜ë‹¤ ìˆœ ì •ë ¬' : 'ê°€ë‚˜ë‹¤ ì—­ìˆœ ì •ë ¬'; render(); });

    // initial render
    render();
    
  // === ë°”ëŒ-ìŠ¤ì›° ë°©í–¥ ìœ„ì ¯ ===
  (function(){
    const DIR_DEG = {N:0, NE:45, E:90, SE:135, S:180, SW:225, W:270, NW:315};
    const sector = document.getElementById('sector');
    const arc30 = document.getElementById('arc30');
    const windArrow = document.getElementById('windArrow');
    const swellArrow = document.getElementById('swellArrow');
    const btns = document.querySelectorAll('.dir-btn');

    function toRad(d){ return d * Math.PI / 180; }

    // ë„ë„› ì„¹í„° path (rOuter: 90, rInner: 60, ê¸°ë³¸ ì¤‘ì‹¬ 100,100)
    function sectorPath(cx, cy, rInner, rOuter, startDeg, endDeg){
      const large = (endDeg - startDeg) % 360 > 180 ? 1 : 0;
      const sRo = toRad(startDeg), eRo = toRad(endDeg);
      const x1o = cx + rOuter*Math.cos(sRo), y1o = cy + rOuter*Math.sin(sRo);
      const x2o = cx + rOuter*Math.cos(eRo), y2o = cy + rOuter*Math.sin(eRo);
      const x2i = cx + rInner*Math.cos(eRo), y2i = cy + rInner*Math.sin(eRo);
      const x1i = cx + rInner*Math.cos(sRo), y1i = cy + rInner*Math.sin(sRo);
      return [
        `M ${x1o} ${y1o}`,
        `A ${rOuter} ${rOuter} 0 ${large} 1 ${x2o} ${y2o}`,
        `L ${x2i} ${y2i}`,
        `A ${rInner} ${rInner} 0 ${large} 0 ${x1i} ${y1i}`,
        'Z'
      ].join(' ');
    }

    // ì›í˜¸ path (ë°˜ê²½ rMid, ë‘ê»˜ëŠ” strokeë¡œ í‘œí˜„)
    function arcPath(cx, cy, rMid, startDeg, endDeg){
      const large = (endDeg - startDeg) % 360 > 180 ? 1 : 0;
      const sRo = toRad(startDeg), eRo = toRad(endDeg);
      const x1 = cx + rMid*Math.cos(sRo), y1 = cy + rMid*Math.sin(sRo);
      const x2 = cx + rMid*Math.cos(eRo), y2 = cy + rMid*Math.sin(eRo);
      return `M ${x1} ${y1} A ${rMid} ${rMid} 0 ${large} 1 ${x2} ${y2}`;
    }

    function setDir(dir){
      const a = DIR_DEG[dir];
      // Offshore wind = a (ë°”ë‹¤ ë°©í–¥). ìŠ¤ì›° ì¤‘ì‹¬ = a + 180
      const center = (a + 180) % 360;
      const start45 = (center - 45 + 360) % 360;
      const end45 = (center + 45) % 360;
      const start30 = (center - 30 + 360) % 360;
      const end30 = (center + 30) % 360;

      windArrow.setAttribute('transform', `rotate(${a} 100 100)`);
      swellArrow.setAttribute('transform', `rotate(${center} 100 100)`);

      sector.setAttribute('d', sectorPath(100,100,60,90,start45,end45));
      arc30.setAttribute('d', arcPath(100,100,75,start30,end30));

      btns.forEach(b=> b.setAttribute('aria-pressed','false'));
      const active = Array.from(btns).find(b=>b.dataset.dir===dir);
      if(active) active.setAttribute('aria-pressed','true');
    }

    btns.forEach(b=> b.addEventListener('click', ()=> setDir(b.dataset.dir)));
    // ì´ˆê¸°ê°’ N(ìœ„ë¡œ ë°”ëŒ) ê¸°ì¤€
    setDir('N');
  })();

</script>
</body>
</html>
